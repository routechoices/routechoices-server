{% extends "dashboard/club_view.html" %}
{% load static %}
{% load django_bootstrap5 %}
{% load hosts %}
{% load compress %}
{%  block extra_head %}
{{ block.super }}
{% compress css %}
<link rel="stylesheet" href="{% static '/vendor/tom-select-2.0.1/tom-select.bootstrap5.min.css' %}" />
<link rel="stylesheet" href="{% static '/vendor/tempus-dominus-6-custom-2/css/tempus-dominus.css' %}"/>
<link rel="stylesheet" href="{% static 'styles/dashboard/event_edit.css' %}"/>
{% endcompress %}
{%  endblock %}

{% block sub_sub_content %}
<div class="row">
    <div class="col-12">
        <h1>Edit {{event.name}} competitors <small><span class="utc-offset"></span></small></h1>
        <div style="margin-bottom: 15px;">
        <form method="GET" class="row">
          <div class="col-auto">
            <input class="form-control" type="search" value="{{search_query}}" name="q" placeholder="Search term"/>
          </div>
          <div class="col-auto">
            <button class="btn btn-primary" type="submit"><i class="fa fa-search"></i> Search</button>
          </div>
        </form>
        </div>
        {% if competitors.paginator.num_pages > 1 %}{% bootstrap_pagination competitors extra=request.GET.urlencode %}{% endif %}
        <form action="" method="post">
            {% csrf_token %}
            <h3>Competitors</h3>
            {% if not competitors.object_list and search_query %}<h4>No competitors matches this search</h4>{% endif %}
            {% bootstrap_formset_errors formset %}
            <table class="table competitor_table">
            {{ formset.management_form }}
            {% for form in formset %}
               {% bootstrap_form_errors form type='non_fields' %}
               {% if forloop.first %}
                    <thead>
                    <tr>
                        {% for field in form.visible_fields %}
                            <th>{{ field.label|capfirst }}</th>
                        {% endfor %}
                    </tr>
                    </thead>
                {% endif %}
                <tr class="formset_row">
                    {% for field in form.visible_fields %}
                        <td>
                            {# Include the hidden fields in the form #}
                            {% if forloop.first %}
                                {% for hidden in form.hidden_fields %}
                                    {{ hidden }}
                                {% endfor %}
                            {% endif %}
                            {% bootstrap_field field show_label=False %}
                        </td>
                    {% endfor %}
                </tr>
            {% endfor %}
            </table>
            <hr class="table-bottom"/>
            {% if competitors.paginator.num_pages > 1 %}{% bootstrap_pagination competitors extra=request.GET.urlencode %}{% endif %}
            <input type="submit" value="Save" class="btn btn-primary" id="submit-btn" style="margin-bottom: 3px"/>
            {% if context == 'edit' %}<a href="{% url 'dashboard:event_delete_view' event_id=event.aid %}" class="btn btn-danger" style="margin-bottom: 3px">Delete</a>{% endif %}
        </form>
    </div>
</div>
{% endblock %}

{%  block extra_body %}
<script src="{% static '/scripts/load-local-variables.js' %}?_=2022072900" data-api-base-url="{% host_url 'api_doc' host 'api' %}"></script>
{% compress js %}
<script src="{% static '/vendor/jquery-3.6.0/jquery.min.js' %}"></script>
<script src="{% static '/vendor/jquery-formset-1.3.2/jquery.formset.js' %}"></script>
<script src="{% static '/vendor/tom-select-2.0.1/tom-select.custom.js' %}"></script>
<script src="{% static '/vendor/popper-2.11.4/popper.min.js' %}"></script>
<script src="{% static '/vendor/tempus-dominus-6-custom-2/js/tempus-dominus.js' %}"></script>
<script src="{% static '/vendor/umbrella-3.3.0/umbrella.min.js' %}"></script>
<script src="{% static '/vendor/papaparse-5.0.0-beta/papaparse.min.js' %}"></script>
<script src="{% static '/vendor/dayjs-1.10.6/dayjs.min.js' %}"></script>
<script src="{% static '/vendor/reqwest-2.0.5/reqwest.min.js' %}"></script>
<script src="{% static '/scripts/dashboard/event_competitors.js' %}"></script>
{% endcompress %}
{%  endblock %}
